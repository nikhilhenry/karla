#!/bin/bash
path=`dirname $BASH_SOURCE`


usageError () {
    echo "Usuage Error"
}

argumentManager () {
    if [[ -d "$path/support/$1" ]]
    then

        python3 $path/support/$1/main.py $@
        shift $#

    elif (( $# == 1 ))
    then 
        
        #CASE
        case $1 in
            #PRINT USAGE
            "--help" | "-h")
                cat $path/info.txt
                exit 0
                ;;

            #PRINT VERSION
            "--version" | "-v")
                cat $path/info.txt | head -1
                exit 0
                ;;

            #SELF UPDATE
            "update" | "u" | "upgrade")
                git pull
                exit 0
                ;;

            #INCORRECT USAGE
            *)
                usageError
                exit 0
                ;;
        esac

    #TWO ARGUMENT FUNCTIONS
    elif (( $# == 2 ))
    then

        case $1 in

            #UPDATE
            "--update" | "-u")
                if [[ -d $path/support/$2 ]]
                then
                    rm -rf $path/support/$2
                    git clone https://github.com/trishitdedhia/$2.git $path/support/$2
                    exit 0
                fi
                ;;

            #PRINT VERSION
            "--version" | "-v")
                cat $path/support/$2/info.txt | head -1
                exit 0
                ;;

            #LEARN
            "learn" | "install")
                if [[ -d $path/support/$2 ]]
                then
                    echo "I already know this skill!"
                else
                    git clone https://github.com/trishitdedhia/$2.git $path/support/$2
                fi
                exit 0
                ;;
            
            #FORGET
            "forget" | "unlearn")
                if [[ -d $path/support/$2 ]]
                then
                    rm -rf $path/support/$2
                else
                    echo "I didn't know about $2 anyway!"
                fi
                exit 0
                ;;

            #DEFAULT
            *)
                usageError
                exit 0
                ;;
            esac

    fi           
                
}

while [[ $# != 0 ]]
do
    argumentManager "$@"
done
